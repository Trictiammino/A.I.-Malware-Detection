import functions

# path dei file
Y_path = "dataset/EmberYTrain.csv"
X_path = "dataset/EmberXTrain.csv"

# caricamento dei file
Y = functions.load(Y_path)
X = functions.load(X_path)

# calcolo del mutual info rank
rank = functions.mutual_info_rank(X, Y)
print("\nMutual information di ogni colonna:\n", rank)

# selezione dei nomi delle feature la cui mutual information supera la soglia
selected_features = functions.top_feature_select(rank, 0.1)
print("\n\nTop feature selezionate:\n", selected_features)

# estrazione delle chiavi (nomi delle feature selezionate) dalle coppie (k,v)
chiavi_da_mantenere = [coppia[0] for coppia in selected_features]

# creazione di un dataset contenente le feature selezionate
X_selected = X.loc[:, chiavi_da_mantenere]

print("\nSalvando le feature selezionate come 'X_selected' nella cartella 'dataset'...")
X_selected.to_csv("dataset/X_selected.csv", index=False)
print("\nSalvando le feature selezionate come 'X_selected' nella cartella 'dataset'... completato!\n")
